{
  extends: [
    'config:base',
    'docker:enableMajor',
    ':disableRateLimiting',
    ':dependencyDashboard',
    ':semanticCommits',
    ':enablePreCommit',
    ':automergeDigest',
    ':automergeBranch',
    'github>mchestr/home-cluster//.github/renovate/allowedVersions.json5',
    'github>mchestr/home-cluster//.github/renovate/autoMerge.json5',
    'github>mchestr/home-cluster//.github/renovate/groups.json5',
    'github>mchestr/home-cluster//.github/renovate/labels.json5',
    'github>mchestr/home-cluster//.github/renovate/semanticCommits.json5'
  ],
  platform: 'github',
  repositories: ['mchestr/home-cluster'],
  timezone: 'America/Vancouver',
  onboarding: false,
  requireConfig: 'optional',
  dependencyDashboardTitle: 'Renovate Dashboard',
  suppressNotifications: ['prIgnoreNotification'],
  rebaseWhen: 'conflicted',
  commitBodyTable: true,
  'docker-compose': {
    fileMatch: ['ansible/.+/docker-compose.*\\.ya?ml(\\.j2)?$']
  },
  flux: {
    fileMatch: ['kubernetes/.+\\.ya?ml$']
  },
  'helm-values': {
    fileMatch: ['kubernetes/.+\\.ya?ml$']
  },
  kubernetes: {
    fileMatch: ['kubernetes/.+\\.ya?ml$']
  },
  regexManagers: [
    {
      description: 'Process custom dependencies',
      fileMatch: ['ansible/.+\\.ya?ml$', 'kubernetes/.+\\.ya?ml$', '\\.taskfiles/.+\\.ya?ml$', 'talos/.+\\.ya?ml$'],
      matchStrings: [
        'datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( versioning=(?<versioning>\\S+))?\n.*?"(?<currentValue>.*)"\n'
      ],
      datasourceTemplate: '{{#if datasource}}{{{datasource}}}{{else}}github-releases{{/if}}',
      versioningTemplate: '{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}'
    }
  ],
  packageRules: [
    {
      description: 'Loose versioning for non-semver packages',
      matchDatasources: ['docker'],
      versioning: 'loose',
      matchPackagePatterns: ['changedetection', 'immich', 'plex', 'qbittorrent']
    }
  ]
}
