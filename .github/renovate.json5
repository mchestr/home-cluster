{
  extends: [
    'config:recommended',
    'docker:enableMajor',
    ':disableRateLimiting',
    ':dependencyDashboard',
    ':semanticCommits',
    ':automergeDigest',
    ':automergeBranch',
    'github>mchestr/home-cluster//.github/renovate/allowedVersions.json5',
    'github>mchestr/home-cluster//.github/renovate/autoMerge.json5',
    'github>mchestr/home-cluster//.github/renovate/groups.json5',
    'github>mchestr/home-cluster//.github/renovate/labels.json5',
    'github>mchestr/home-cluster//.github/renovate/semanticCommits.json5',
    'helpers:pinGitHubActionDigests'
  ],
  platform: 'github',
  username: 'mchesterbot[bot]',
  gitAuthor: 'mchesterbot <202745+mchesterbot[bot]@users.noreply.github.com>',
  timezone: 'America/Vancouver',
  onboarding: false,
  requireConfig: 'optional',
  dependencyDashboardTitle: 'Renovate Dashboard',
  suppressNotifications: ['prIgnoreNotification'],
  'docker-compose': {
    fileMatch: ['ansible/.+/docker-compose.*\\.ya?ml(\\.j2)?$']
  },
  flux: {
    fileMatch: ['kubernetes/.+\\.ya?ml$', 'talos/.+\\.ya?ml$', 'terraform/.+\\.tf$']
  },
  'helm-values': {
    fileMatch: ['kubernetes/.+\\.ya?ml$', 'talos/.+\\.ya?ml$', 'terraform/.+\\.tf$']
  },
  kubernetes: {
    fileMatch: ['kubernetes/.+\\.ya?ml$', 'talos/.+\\.ya?ml$', 'terraform/.+\\.tf$']
  },
  regexManagers: [
    {
      description: 'Process custom dependencies',
      fileMatch: ['ansible/.+\\.ya?ml$', 'kubernetes/.+\\.ya?ml$', '\\.taskfiles/.+\\.ya?ml$', 'talos/.+\\.ya?ml$', 'terraform/.+\\.tf$'],
      matchStrings: [
        'datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( packageName=(?<packageName>\\S+))?( versioning=(?<versioning>\\S+))?(?:\\s+extractVersion=(?<extractVersion>.+?))?\n.*?"(?<currentValue>.*)"\n'
      ],
      datasourceTemplate: '{{#if datasource}}{{{datasource}}}{{else}}github-releases{{/if}}',
      versioningTemplate: '{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}',
      packageNameTemplate: '{{#if packageName}}{{{packageName}}}{{else}}{{{depName}}}{{/if}}'
    },
    {
      description: 'Process Talos version README badge.io Markdown',
      fileMatch: ['README.md'],
      matchStrings: [
        'https:\\/\\/img.shields.io\\/badge\\/Talos-(?<currentValue>\\S+\\d)'
      ],
      datasourceTemplate: 'github-releases',
      depNameTemplate: 'siderolabs/talos'
    },
    {
      description: 'Process Kubernetes version README badge.io Markdown',
      fileMatch: ['README.md'],
      matchStrings: [
        'https:\\/\\/img.shields.io\\/badge\\/k8s-(?<currentValue>\\S+\\d)'
      ],
      datasourceTemplate: 'github-releases',
      depNameTemplate: 'siderolabs/kubelet'
    }
  ],
  packageRules: [
    {
      description: 'Loose versioning for non-semver packages',
      matchDatasources: ['docker'],
      versioning: 'loose',
      matchPackagePatterns: ['changedetection', 'plex', 'qbittorrent']
    }
  ]
}
