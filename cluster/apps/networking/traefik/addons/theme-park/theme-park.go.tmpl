{{ $theme := "plex" }}
http:
  middlewares:
    #  Add any suppported base apps you would like to include in your auto generated middle set. "sonarr" and "radarr are the examples here.
    {{ range $index, $app := list "sonarr" "radarr" "lidarr" "readarr" "prowlarr" "bazarr" "overseerr" "tautulli" "nzbget" "qbittorrent" "bitwarden" }}
    {{ $app }}-theme-css:
      plugin:
        rewritebody:
          rewrites:
            - regex: </head>
              replacement: <link rel="stylesheet" type="text/css" href="https://theme-park.${CLUSTER_DOMAIN}/css/base/{{ $app }}/{{ $theme }}.css"></head>

    # Wrap CSS and theme headers in single middleware for ease of use
    {{ $app }}-theme:
      chain:
        middlewares:
          - theme-headers
          - {{ $app }}-theme-css
    {{ end }}

    #  4k addon section
    {{ range $index, $app := list "radarr" }}
    {{ $app }}-4k-theme-css:
      plugin:
        rewritebody:
          rewrites:
            - regex: </head>
              replacement: <link rel="stylesheet" type="text/css" href="https://theme-park.${CLUSTER_DOMAIN}/css/base/{{ $app }}/{{ $theme }}.css"><link rel="stylesheet" type="text/css" href="https://theme-park.${CLUSTER_DOMAIN}/css/addons/{{ $app }}/{{ $app }}-4k-logo/{{ $app }}-4k-logo.css"></head>

    # Wrap CSS and theme headers in single middleware for ease of use
    {{ $app }}-4k-theme:
      chain:
        middlewares:
          - theme-headers
          - {{ $app }}-4k-theme-css
    {{ end }}
